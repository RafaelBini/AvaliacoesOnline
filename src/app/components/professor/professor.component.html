<app-barra-navegacao [caminho]="caminho"></app-barra-navegacao>

<mat-tab-group mat-align-tabs="center" mat-stretch-tabs [selectedIndex]="selectedTab"
    (selectedIndexChange)="tabAlterada($event)">
    <mat-tab>
        <ng-template mat-tab-label>
            <mat-icon style="margin-right: 8px;">description</mat-icon>
            Avaliações
        </ng-template>

        <div style="position: relative;">

            <div style="background-color: whitesmoke; padding: 15px;">
                <table style="width: 50%; margin: auto; display: block;">
                    <tr>
                        <td width="95%">
                            <input type="text" class="input-clean" style="width: 100%;" #inputBusca maxlength="85"
                                (keyup)="onBuscaKeyUp(inputBusca.value)"
                                placeholder="Digite aqui uma parte do titulo, descrição ou tag da avaliação que procura" />
                        </td>
                        <td width="5%" style="padding: 5px;">
                            <button mat-icon-button>
                                <mat-icon style="color: gray;">search</mat-icon>
                            </button>
                        </td>
                    </tr>
                </table>
            </div>

            <mat-tab-group mat-align-tabs="center" *ngIf="agruparAvaliacoes" [selectedIndex]="selectedStatusTab">

                <mat-tab *ngFor="let status of comumService.statusAvaliacao">
                    <ng-template mat-tab-label>
                        {{status.nome}} ({{getAvaliacoesNoStatus(status.id).length}})
                    </ng-template>

                    <table style="width: 100%;  margin-top: 20px;">
                        <tr *ngFor="let avaliacao of getAvaliacoesNoStatus(status.id)">
                            <td>
                                <app-avaliacao-card-professor [avaliacao]="avaliacao"></app-avaliacao-card-professor>
                            </td>
                        </tr>
                    </table>

                </mat-tab>
            </mat-tab-group>

            <table *ngIf="agruparAvaliacoes == false" style="width: 100%; margin-top: 20px;">
                <tr *ngFor="let avaliacao of avaliacoesFiltradas">
                    <td>
                        <app-avaliacao-card-professor [avaliacao]="avaliacao"></app-avaliacao-card-professor>
                    </td>
                </tr>

            </table>

        </div>

        <button mat-fab [matMenuTriggerFor]="menu" matTooltip="Opções de Filtro"
            style="z-index: 1000; position: fixed; right: 50px; bottom: 120px; background-color: var(--cor-primaria); color: white">
            <mat-icon>more_vert</mat-icon>
        </button>
        <mat-menu #menu="matMenu" yPosition="above" xPosition="before">
            <button mat-menu-item (click)="agruparAvaliacoes = !agruparAvaliacoes">
                {{agruparAvaliacoes ? 'Desagrupar' : 'Agrupar'}}
            </button>
        </mat-menu>

        <a routerLink="/professor/avaliacao/nova" matTooltip="Nova Avaliação"
            style="z-index: 1000; position: fixed; right: 50px; bottom: 50px; background-color: var(--cor-primaria); color: white"
            mat-fab>
            <mat-icon>add</mat-icon>
        </a>

    </mat-tab>
    <mat-tab>
        <ng-template mat-tab-label>
            <mat-icon style="margin-right: 8px;">recent_actors</mat-icon>
            Alunos
        </ng-template>

        <table class="tabela-alunos">
            <tr>
                <td align="center">
                    <input type="checkbox" />
                </td>
                <td align="center">
                    <b>Matricula</b>
                </td>
                <td align="center">
                    <b>Nome</b>
                </td>
                <td align="center">
                    <b>Email</b>
                </td>
                <td align="center">
                    <b>Opções</b>
                </td>
            </tr>
            <tr *ngFor="let aluno of alunos" class="aluno-line">
                <td align="center">
                    <input type="checkbox" />
                </td>
                <td align="center">
                    {{aluno.matricula}}
                </td>
                <td>
                    {{aluno.nome}}
                </td>
                <td>
                    {{aluno.email}}
                </td>
                <td align="center">
                    <button mat-icon-button>
                        <mat-icon>
                            create
                        </mat-icon>
                    </button>
                    <button mat-icon-button>
                        <mat-icon style="color: var(--cor-perigosa)">
                            delete
                        </mat-icon>
                    </button>
                </td>
            </tr>
        </table>


        <button (click)="addAluno()" matTooltip="Novo Aluno"
            style="position: fixed; right: 100px; bottom: 50px; background-color: var(--cor-primaria); color: white"
            mat-fab>
            <mat-icon>add</mat-icon>
        </button>
        <a matTooltip="Importar alunos via CSV"
            style="position: fixed; right: 30px; bottom: 50px; background-color: var(--cor-primaria); color: white"
            mat-fab>
            <mat-icon>arrow_upward</mat-icon>
        </a>



    </mat-tab>
    <mat-tab>
        <ng-template mat-tab-label>
            <mat-icon style="margin-right: 8px;">account_circle</mat-icon>
            Meu Perfil
        </ng-template>

        <div style="background-color: whitesmoke; width: 50%; border-radius: 10px; margin: auto;">
            <table class="tabela-editar-perfil">
                <tr>
                    <td colspan='2' align="center">
                        <h2>Alterar Meus Dados</h2>
                    </td>
                </tr>
                <tr>
                    <td width="30%">
                        E-mail:
                    </td>
                    <td>
                        <input required type="email" value="professor@ufpr.br" name="email">
                    </td>
                </tr>
                <tr>
                    <td>
                        Senha:
                    </td>
                    <td>
                        <input required [disabled]="!alterar" type="password" value="senha123" name="senha">

                        <button (click)="alterar = true" mat-button matTooltip="Alterar senha">
                            <mat-icon>create</mat-icon>
                        </button>
                    </td>
                </tr>
                <tr *ngIf="alterar">
                    <td>
                        Confirmar Senha:
                    </td>
                    <td>
                        <input required type="password" class="form-control" value="" name="nova_senha">
                    </td>
                </tr>
                <tr>
                    <td colspan='2' align="center">
                        <button type="button" mat-raised-button>Editar</button>
                    </td>
                </tr>

            </table>
        </div>



    </mat-tab>
    <mat-tab>
        <ng-template mat-tab-label>
            <mat-icon style="margin-right: 8px;">dashboard</mat-icon>
            Dashboard
        </ng-template>

    </mat-tab>
</mat-tab-group>